#pragma once
#include <vector>
#include <string>
#include "Core/Vulnerability.h"

class VulnerabilityReporter {
private:
    std::vector<Vulnerability> vulnerabilities;
    std::string outputFormat;

    std::string generateTextReport() const;
    std::string generateJsonReport() const;
    std::string escapeJsonString(const std::string& input) const;

public:
    VulnerabilityReporter(
        const std::vector<Vulnerability>& vulnerabilities,
        const std::string& outputFormat = "text"
    );

    std::string generateReport() const;
};