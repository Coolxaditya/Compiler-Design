#include "Core/Vulnerability.h"
#include <sstream>

Vulnerability::Vulnerability(
    VulnerabilityType type,
    const std::string& filePath,
    int lineNumber,
    int column,
    SeverityLevel severity,
    const std::string& description,
    const std::string& codeSnippet,
    const std::string& possibleFix
) : type(type), filePath(filePath), lineNumber(lineNumber), column(column),
    severity(severity), description(description), codeSnippet(codeSnippet),
    possibleFix(possibleFix) {}

std::string Vulnerability::toString() const {
    std::ostringstream oss;
    oss << to_string(severity) << " - " << to_string(type) << ": " << description << "\n"
        << "Location: " << filePath << ":" << lineNumber << ":" << column << "\n"
        << "Code: " << codeSnippet << "\n";
    
    if (!possibleFix.empty()) {
        oss << "Fix: " << possibleFix;
    } else {
        oss << "Fix: Not available";
    }
    
    return oss.str();
}